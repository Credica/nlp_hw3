2025-12-24 01:11:20,428:INFO: ============================================================
2025-12-24 01:11:20,429:INFO: Training Configuration
2025-12-24 01:11:20,429:INFO: ============================================================
2025-12-24 01:11:20,430:INFO: Dataset: 100k
2025-12-24 01:11:20,430:INFO: Chinese vocab size: 14769
2025-12-24 01:11:20,431:INFO: English vocab size: 8000
2025-12-24 01:11:20,431:INFO: Data directory: ./data_100k
2025-12-24 01:11:20,431:INFO: ============================================================
2025-12-24 01:11:20,432:INFO: Architecture Configuration:
2025-12-24 01:11:20,432:INFO:   Position Encoding: relative
2025-12-24 01:11:20,433:INFO:   Normalization: rmsnorm
2025-12-24 01:11:20,433:INFO:   Max Relative Position: 32
2025-12-24 01:11:20,433:INFO:   Model dimension: 512
2025-12-24 01:11:20,434:INFO:   Attention heads: 8
2025-12-24 01:11:20,434:INFO:   Layers: 6
2025-12-24 01:11:20,434:INFO:   Feed-forward dim: 2048
2025-12-24 01:11:20,434:INFO:   Dropout: 0.1
2025-12-24 01:11:20,435:INFO: ============================================================
2025-12-24 01:11:20,435:INFO: Training Configuration:
2025-12-24 01:11:20,435:INFO:   Batch size: 64
2025-12-24 01:11:20,436:INFO:   Epochs: 50
2025-12-24 01:11:20,436:INFO:   Learning rate: 0.0005
2025-12-24 01:11:20,437:INFO:   Use NoamOpt: True
2025-12-24 01:11:20,437:INFO:   Use Label Smoothing: False
2025-12-24 01:11:20,437:INFO: ============================================================
2025-12-24 01:11:20,438:INFO: Model will be saved to: ./experiment/100k_rel_rms_noam_nosmooth/model_100k_rel_rms_noam_nosmooth.pth
2025-12-24 01:11:20,438:INFO: ============================================================
2025-12-24 01:11:20,936:INFO: -------- Dataset Build! --------
2025-12-24 01:11:20,937:INFO: -------- Get Dataloader! --------
2025-12-24 01:11:22,879:DEBUG: Building prefix dict from the default dictionary ...
2025-12-24 01:11:22,880:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-24 01:11:23,475:DEBUG: Loading model cost 0.595 seconds.
2025-12-24 01:11:23,476:DEBUG: Prefix dict has been built successfully.
2025-12-24 01:14:05,677:INFO: Epoch: 1, loss: 5.352925777435303
2025-12-24 01:15:21,095:INFO: Epoch: 1, Dev loss: 4.844593048095703, Bleu Score: 2.462113822898666
2025-12-24 01:15:22,645:INFO: -------- Save Best Model! --------
2025-12-24 01:18:11,112:INFO: Epoch: 2, loss: 3.564589738845825
2025-12-24 01:19:37,820:INFO: Epoch: 2, Dev loss: 4.298508167266846, Bleu Score: 4.441367818609627
2025-12-24 01:19:39,300:INFO: -------- Save Best Model! --------
2025-12-24 01:22:20,593:INFO: Epoch: 3, loss: 2.960120916366577
2025-12-24 01:23:39,130:INFO: Epoch: 3, Dev loss: 4.009570121765137, Bleu Score: 5.57163497949354
2025-12-24 01:23:40,676:INFO: -------- Save Best Model! --------
2025-12-24 01:26:17,897:INFO: Epoch: 4, loss: 2.589470148086548
2025-12-24 01:27:44,280:INFO: Epoch: 4, Dev loss: 3.8337996006011963, Bleu Score: 7.033219076352391
2025-12-24 01:27:45,858:INFO: -------- Save Best Model! --------
2025-12-24 01:30:20,696:INFO: Epoch: 5, loss: 2.333094835281372
2025-12-24 01:31:46,460:INFO: Epoch: 5, Dev loss: 3.773806571960449, Bleu Score: 6.908655671548807
2025-12-24 01:31:46,461:INFO: Early Stop Left: 4
2025-12-24 01:34:22,099:INFO: Epoch: 6, loss: 2.1331369876861572
2025-12-24 01:35:39,735:INFO: Epoch: 6, Dev loss: 3.7335329055786133, Bleu Score: 7.058383752277603
2025-12-24 01:35:41,255:INFO: -------- Save Best Model! --------
2025-12-24 01:38:18,517:INFO: Epoch: 7, loss: 1.965160608291626
2025-12-24 01:39:51,171:INFO: Epoch: 7, Dev loss: 3.7065000534057617, Bleu Score: 8.679362275642218
2025-12-24 01:39:52,700:INFO: -------- Save Best Model! --------
2025-12-24 01:42:31,273:INFO: Epoch: 8, loss: 1.8190020322799683
2025-12-24 01:44:00,231:INFO: Epoch: 8, Dev loss: 3.719707727432251, Bleu Score: 8.642285206772476
2025-12-24 01:44:00,232:INFO: Early Stop Left: 4
2025-12-24 01:46:38,264:INFO: Epoch: 9, loss: 1.690176010131836
2025-12-24 01:48:15,126:INFO: Epoch: 9, Dev loss: 3.7696826457977295, Bleu Score: 8.858765232336294
2025-12-24 01:48:16,651:INFO: -------- Save Best Model! --------
2025-12-24 01:50:48,410:INFO: Epoch: 10, loss: 1.571799635887146
2025-12-24 01:52:11,298:INFO: Epoch: 10, Dev loss: 3.8040761947631836, Bleu Score: 8.385223430394436
2025-12-24 01:52:11,299:INFO: Early Stop Left: 4
2025-12-24 01:54:47,199:INFO: Epoch: 11, loss: 1.4667681455612183
2025-12-24 01:56:16,825:INFO: Epoch: 11, Dev loss: 3.836137294769287, Bleu Score: 9.517886691202035
2025-12-24 01:56:18,345:INFO: -------- Save Best Model! --------
2025-12-24 01:58:56,401:INFO: Epoch: 12, loss: 1.370160698890686
2025-12-24 02:00:25,282:INFO: Epoch: 12, Dev loss: 3.90917706489563, Bleu Score: 9.067009900615155
2025-12-24 02:00:25,283:INFO: Early Stop Left: 4
2025-12-24 02:03:04,441:INFO: Epoch: 13, loss: 1.2820924520492554
2025-12-24 02:04:32,935:INFO: Epoch: 13, Dev loss: 3.9832375049591064, Bleu Score: 8.76735840327899
2025-12-24 02:04:32,936:INFO: Early Stop Left: 3
2025-12-24 02:07:10,873:INFO: Epoch: 14, loss: 1.2004590034484863
2025-12-24 02:08:36,316:INFO: Epoch: 14, Dev loss: 4.050058364868164, Bleu Score: 8.74557681240487
2025-12-24 02:08:36,318:INFO: Early Stop Left: 2
2025-12-24 02:11:13,182:INFO: Epoch: 15, loss: 1.1261197328567505
2025-12-24 02:12:45,885:INFO: Epoch: 15, Dev loss: 4.131937503814697, Bleu Score: 8.84770556737957
2025-12-24 02:12:45,886:INFO: Early Stop Left: 1
2025-12-24 02:15:22,275:INFO: Epoch: 16, loss: 1.0579850673675537
2025-12-24 02:16:53,924:INFO: Epoch: 16, Dev loss: 4.20451021194458, Bleu Score: 8.51445279164495
2025-12-24 02:16:53,925:INFO: Early Stop Left: 0
2025-12-24 02:16:53,926:INFO: -------- Early Stop! --------
2025-12-24 02:16:53,926:INFO: 
============================================================
2025-12-24 02:16:53,926:INFO: Training completed! Evaluating on test set...
2025-12-24 02:16:53,926:INFO: ============================================================
2025-12-24 02:17:42,846:INFO: 
Final Test Set BLEU Score: 8.37
2025-12-24 02:17:45,910:INFO: Test Set BLEU Score (Greedy): 7.33
2025-12-24 02:17:45,911:INFO: Improvement with Beam Search: 1.04 BLEU points
2025-12-24 02:17:45,912:INFO: ============================================================
