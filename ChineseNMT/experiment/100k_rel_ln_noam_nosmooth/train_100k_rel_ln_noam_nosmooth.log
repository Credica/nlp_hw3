2025-12-23 20:07:40,273:INFO: ============================================================
2025-12-23 20:07:40,274:INFO: Training Configuration
2025-12-23 20:07:40,274:INFO: ============================================================
2025-12-23 20:07:40,274:INFO: Dataset: 100k
2025-12-23 20:07:40,274:INFO: Chinese vocab size: 14769
2025-12-23 20:07:40,275:INFO: English vocab size: 8000
2025-12-23 20:07:40,275:INFO: Data directory: ./data_100k
2025-12-23 20:07:40,275:INFO: ============================================================
2025-12-23 20:07:40,275:INFO: Architecture Configuration:
2025-12-23 20:07:40,276:INFO:   Position Encoding: relative
2025-12-23 20:07:40,276:INFO:   Normalization: layernorm
2025-12-23 20:07:40,276:INFO:   Max Relative Position: 32
2025-12-23 20:07:40,276:INFO:   Model dimension: 512
2025-12-23 20:07:40,276:INFO:   Attention heads: 8
2025-12-23 20:07:40,277:INFO:   Layers: 6
2025-12-23 20:07:40,277:INFO:   Feed-forward dim: 2048
2025-12-23 20:07:40,277:INFO:   Dropout: 0.1
2025-12-23 20:07:40,277:INFO: ============================================================
2025-12-23 20:07:40,277:INFO: Training Configuration:
2025-12-23 20:07:40,278:INFO:   Batch size: 64
2025-12-23 20:07:40,278:INFO:   Epochs: 50
2025-12-23 20:07:40,278:INFO:   Learning rate: 0.0005
2025-12-23 20:07:40,278:INFO:   Use NoamOpt: True
2025-12-23 20:07:40,279:INFO:   Use Label Smoothing: False
2025-12-23 20:07:40,279:INFO: ============================================================
2025-12-23 20:07:40,279:INFO: Model will be saved to: ./experiment/100k_rel_ln_noam_nosmooth/model_100k_rel_ln_noam_nosmooth.pth
2025-12-23 20:07:40,279:INFO: ============================================================
2025-12-23 20:07:40,792:INFO: -------- Dataset Build! --------
2025-12-23 20:07:40,793:INFO: -------- Get Dataloader! --------
2025-12-23 20:07:42,706:DEBUG: Building prefix dict from the default dictionary ...
2025-12-23 20:07:42,707:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-23 20:07:43,318:DEBUG: Loading model cost 0.611 seconds.
2025-12-23 20:07:43,319:DEBUG: Prefix dict has been built successfully.
2025-12-23 20:10:39,340:INFO: Epoch: 1, loss: 5.406120300292969
2025-12-23 20:11:50,238:INFO: Epoch: 1, Dev loss: 4.897813320159912, Bleu Score: 1.9614465689107525
2025-12-23 20:11:51,783:INFO: -------- Save Best Model! --------
2025-12-23 20:14:47,512:INFO: Epoch: 2, loss: 3.603538751602173
2025-12-23 20:16:30,582:INFO: Epoch: 2, Dev loss: 4.32755708694458, Bleu Score: 3.993341593855468
2025-12-23 20:16:32,157:INFO: -------- Save Best Model! --------
2025-12-23 20:19:33,659:INFO: Epoch: 3, loss: 2.987285852432251
2025-12-23 20:20:49,931:INFO: Epoch: 3, Dev loss: 4.056087970733643, Bleu Score: 5.574170029215326
2025-12-23 20:20:51,486:INFO: -------- Save Best Model! --------
2025-12-23 20:23:50,839:INFO: Epoch: 4, loss: 2.6120083332061768
2025-12-23 20:25:16,534:INFO: Epoch: 4, Dev loss: 3.889653444290161, Bleu Score: 6.272107200584779
2025-12-23 20:25:18,031:INFO: -------- Save Best Model! --------
2025-12-23 20:28:36,205:INFO: Epoch: 5, loss: 2.3523244857788086
2025-12-23 20:30:12,602:INFO: Epoch: 5, Dev loss: 3.825819969177246, Bleu Score: 7.42913410678027
2025-12-23 20:30:14,231:INFO: -------- Save Best Model! --------
2025-12-23 20:33:04,896:INFO: Epoch: 6, loss: 2.1487247943878174
2025-12-23 20:34:25,721:INFO: Epoch: 6, Dev loss: 3.7365949153900146, Bleu Score: 7.728575969268353
2025-12-23 20:34:27,264:INFO: -------- Save Best Model! --------
2025-12-23 20:37:16,362:INFO: Epoch: 7, loss: 1.979499340057373
2025-12-23 20:38:43,467:INFO: Epoch: 7, Dev loss: 3.785707950592041, Bleu Score: 7.761137677729318
2025-12-23 20:38:45,055:INFO: -------- Save Best Model! --------
2025-12-23 20:41:34,793:INFO: Epoch: 8, loss: 1.8313028812408447
2025-12-23 20:43:02,953:INFO: Epoch: 8, Dev loss: 3.7684755325317383, Bleu Score: 8.194518837054897
2025-12-23 20:43:04,502:INFO: -------- Save Best Model! --------
2025-12-23 20:45:55,573:INFO: Epoch: 9, loss: 1.6996748447418213
2025-12-23 20:47:23,966:INFO: Epoch: 9, Dev loss: 3.816927433013916, Bleu Score: 8.45151669243519
2025-12-23 20:47:25,510:INFO: -------- Save Best Model! --------
2025-12-23 20:50:16,630:INFO: Epoch: 10, loss: 1.581217646598816
2025-12-23 20:51:45,570:INFO: Epoch: 10, Dev loss: 3.8669683933258057, Bleu Score: 7.75397833691091
2025-12-23 20:51:45,571:INFO: Early Stop Left: 4
2025-12-23 20:54:37,376:INFO: Epoch: 11, loss: 1.474605679512024
2025-12-23 20:56:06,205:INFO: Epoch: 11, Dev loss: 3.955510377883911, Bleu Score: 8.17928917681049
2025-12-23 20:56:06,206:INFO: Early Stop Left: 3
2025-12-23 20:58:58,254:INFO: Epoch: 12, loss: 1.3769277334213257
2025-12-23 21:00:33,274:INFO: Epoch: 12, Dev loss: 3.993886947631836, Bleu Score: 8.130558026075224
2025-12-23 21:00:33,275:INFO: Early Stop Left: 2
2025-12-23 21:03:20,327:INFO: Epoch: 13, loss: 1.2880520820617676
2025-12-23 21:04:58,727:INFO: Epoch: 13, Dev loss: 4.047548294067383, Bleu Score: 8.674066600031704
2025-12-23 21:05:00,218:INFO: -------- Save Best Model! --------
2025-12-23 21:07:46,188:INFO: Epoch: 14, loss: 1.2059168815612793
2025-12-23 21:09:14,961:INFO: Epoch: 14, Dev loss: 4.14064359664917, Bleu Score: 8.420996827777184
2025-12-23 21:09:14,962:INFO: Early Stop Left: 4
2025-12-23 21:12:02,295:INFO: Epoch: 15, loss: 1.132118582725525
2025-12-23 21:13:38,875:INFO: Epoch: 15, Dev loss: 4.21000862121582, Bleu Score: 7.794276993076404
2025-12-23 21:13:38,876:INFO: Early Stop Left: 3
2025-12-23 21:16:24,692:INFO: Epoch: 16, loss: 1.0626007318496704
2025-12-23 21:17:59,804:INFO: Epoch: 16, Dev loss: 4.319709300994873, Bleu Score: 7.809063533730494
2025-12-23 21:17:59,805:INFO: Early Stop Left: 2
2025-12-23 21:20:46,061:INFO: Epoch: 17, loss: 0.9993284940719604
2025-12-23 21:22:14,550:INFO: Epoch: 17, Dev loss: 4.3495025634765625, Bleu Score: 8.396322884678016
2025-12-23 21:22:14,551:INFO: Early Stop Left: 1
2025-12-23 21:25:00,591:INFO: Epoch: 18, loss: 0.9405156373977661
2025-12-23 21:26:33,009:INFO: Epoch: 18, Dev loss: 4.454317569732666, Bleu Score: 8.181989569951924
2025-12-23 21:26:33,010:INFO: Early Stop Left: 0
2025-12-23 21:26:33,011:INFO: -------- Early Stop! --------
2025-12-23 21:26:33,011:INFO: 
============================================================
2025-12-23 21:26:33,011:INFO: Training completed! Evaluating on test set...
2025-12-23 21:26:33,011:INFO: ============================================================
2025-12-23 21:27:20,352:INFO: 
Final Test Set BLEU Score: 9.08
2025-12-23 21:27:23,710:INFO: Test Set BLEU Score (Greedy): 8.11
2025-12-23 21:27:23,711:INFO: Improvement with Beam Search: 0.97 BLEU points
2025-12-23 21:27:23,712:INFO: ============================================================
