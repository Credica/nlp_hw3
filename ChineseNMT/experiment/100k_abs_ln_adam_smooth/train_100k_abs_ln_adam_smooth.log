2025-12-23 11:08:40,437:INFO: ============================================================
2025-12-23 11:08:40,438:INFO: Training Configuration
2025-12-23 11:08:40,438:INFO: ============================================================
2025-12-23 11:08:40,438:INFO: Dataset: 100k
2025-12-23 11:08:40,438:INFO: Chinese vocab size: 14769
2025-12-23 11:08:40,439:INFO: English vocab size: 8000
2025-12-23 11:08:40,439:INFO: Data directory: ./data_100k
2025-12-23 11:08:40,439:INFO: ============================================================
2025-12-23 11:08:40,439:INFO: Architecture Configuration:
2025-12-23 11:08:40,440:INFO:   Position Encoding: absolute
2025-12-23 11:08:40,440:INFO:   Normalization: layernorm
2025-12-23 11:08:40,441:INFO:   Model dimension: 512
2025-12-23 11:08:40,441:INFO:   Attention heads: 8
2025-12-23 11:08:40,441:INFO:   Layers: 6
2025-12-23 11:08:40,441:INFO:   Feed-forward dim: 2048
2025-12-23 11:08:40,441:INFO:   Dropout: 0.1
2025-12-23 11:08:40,442:INFO: ============================================================
2025-12-23 11:08:40,442:INFO: Training Configuration:
2025-12-23 11:08:40,442:INFO:   Batch size: 64
2025-12-23 11:08:40,442:INFO:   Epochs: 50
2025-12-23 11:08:40,442:INFO:   Learning rate: 0.0005
2025-12-23 11:08:40,443:INFO:   Use NoamOpt: False
2025-12-23 11:08:40,443:INFO:   Use Label Smoothing: True
2025-12-23 11:08:40,443:INFO: ============================================================
2025-12-23 11:08:40,443:INFO: Model will be saved to: ./experiment/100k_abs_ln_adam_smooth/model_100k_abs_ln_adam_smooth.pth
2025-12-23 11:08:40,443:INFO: ============================================================
2025-12-23 11:08:40,969:INFO: -------- Dataset Build! --------
2025-12-23 11:08:40,970:INFO: -------- Get Dataloader! --------
2025-12-23 11:08:42,876:DEBUG: Building prefix dict from the default dictionary ...
2025-12-23 11:08:42,876:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-23 11:08:43,493:DEBUG: Loading model cost 0.617 seconds.
2025-12-23 11:08:43,494:DEBUG: Prefix dict has been built successfully.
2025-12-23 11:12:06,839:INFO: Epoch: 1, loss: 4.616976737976074
2025-12-23 11:13:21,764:INFO: Epoch: 1, Dev loss: 4.578508377075195, Bleu Score: 0.4127066081010186
2025-12-23 11:13:23,409:INFO: -------- Save Best Model! --------
2025-12-23 11:16:20,627:INFO: Epoch: 2, loss: 3.6799371242523193
2025-12-23 11:17:34,882:INFO: Epoch: 2, Dev loss: 4.176023483276367, Bleu Score: 1.2006039617865047
2025-12-23 11:17:36,535:INFO: -------- Save Best Model! --------
2025-12-23 11:20:45,402:INFO: Epoch: 3, loss: 3.190690040588379
2025-12-23 11:22:14,155:INFO: Epoch: 3, Dev loss: 3.8885738849639893, Bleu Score: 2.4965895588203324
2025-12-23 11:22:15,786:INFO: -------- Save Best Model! --------
2025-12-23 11:25:03,976:INFO: Epoch: 4, loss: 2.8337628841400146
2025-12-23 11:26:28,685:INFO: Epoch: 4, Dev loss: 3.712456226348877, Bleu Score: 3.8174676869593887
2025-12-23 11:26:30,331:INFO: -------- Save Best Model! --------
2025-12-23 11:29:17,778:INFO: Epoch: 5, loss: 2.5506844520568848
2025-12-23 11:30:40,515:INFO: Epoch: 5, Dev loss: 3.5416910648345947, Bleu Score: 5.134859752344504
2025-12-23 11:30:42,110:INFO: -------- Save Best Model! --------
2025-12-23 11:33:32,468:INFO: Epoch: 6, loss: 2.320141553878784
2025-12-23 11:35:04,409:INFO: Epoch: 6, Dev loss: 3.468021869659424, Bleu Score: 5.6410589148744865
2025-12-23 11:35:05,970:INFO: -------- Save Best Model! --------
2025-12-23 11:37:53,607:INFO: Epoch: 7, loss: 2.132767915725708
2025-12-23 11:39:15,745:INFO: Epoch: 7, Dev loss: 3.4059929847717285, Bleu Score: 6.118214289007167
2025-12-23 11:39:17,370:INFO: -------- Save Best Model! --------
2025-12-23 11:42:05,425:INFO: Epoch: 8, loss: 1.9797905683517456
2025-12-23 11:43:40,625:INFO: Epoch: 8, Dev loss: 3.358114719390869, Bleu Score: 7.1469339720891725
2025-12-23 11:43:42,314:INFO: -------- Save Best Model! --------
2025-12-23 11:46:28,606:INFO: Epoch: 9, loss: 1.8493491411209106
2025-12-23 11:48:05,040:INFO: Epoch: 9, Dev loss: 3.351438045501709, Bleu Score: 6.922402179139363
2025-12-23 11:48:05,041:INFO: Early Stop Left: 4
2025-12-23 11:50:55,185:INFO: Epoch: 10, loss: 1.7356740236282349
2025-12-23 11:52:26,267:INFO: Epoch: 10, Dev loss: 3.357433795928955, Bleu Score: 7.5319099960471725
2025-12-23 11:52:27,974:INFO: -------- Save Best Model! --------
2025-12-23 11:55:15,731:INFO: Epoch: 11, loss: 1.6333205699920654
2025-12-23 11:56:55,174:INFO: Epoch: 11, Dev loss: 3.3699820041656494, Bleu Score: 7.607373509595733
2025-12-23 11:56:56,872:INFO: -------- Save Best Model! --------
2025-12-23 11:59:44,154:INFO: Epoch: 12, loss: 1.5440106391906738
2025-12-23 12:01:12,519:INFO: Epoch: 12, Dev loss: 3.417745351791382, Bleu Score: 7.2837752169224546
2025-12-23 12:01:12,520:INFO: Early Stop Left: 4
2025-12-23 12:04:00,933:INFO: Epoch: 13, loss: 1.4617390632629395
2025-12-23 12:05:39,764:INFO: Epoch: 13, Dev loss: 3.4398183822631836, Bleu Score: 7.220271988358386
2025-12-23 12:05:39,765:INFO: Early Stop Left: 3
2025-12-23 12:08:28,013:INFO: Epoch: 14, loss: 1.3845881223678589
2025-12-23 12:10:03,432:INFO: Epoch: 14, Dev loss: 3.4692325592041016, Bleu Score: 7.599194357204295
2025-12-23 12:10:03,433:INFO: Early Stop Left: 2
2025-12-23 12:12:51,451:INFO: Epoch: 15, loss: 1.316486120223999
2025-12-23 12:14:24,286:INFO: Epoch: 15, Dev loss: 3.5415868759155273, Bleu Score: 7.383724231578074
2025-12-23 12:14:24,287:INFO: Early Stop Left: 1
2025-12-23 12:17:12,094:INFO: Epoch: 16, loss: 1.2534558773040771
2025-12-23 12:18:48,152:INFO: Epoch: 16, Dev loss: 3.5560107231140137, Bleu Score: 8.409659495687007
2025-12-23 12:18:49,780:INFO: -------- Save Best Model! --------
2025-12-23 12:21:38,936:INFO: Epoch: 17, loss: 1.1944738626480103
2025-12-23 12:23:13,383:INFO: Epoch: 17, Dev loss: 3.5960240364074707, Bleu Score: 7.525717609549272
2025-12-23 12:23:13,384:INFO: Early Stop Left: 4
2025-12-23 12:26:23,314:INFO: Epoch: 18, loss: 1.1407430171966553
2025-12-23 12:28:07,461:INFO: Epoch: 18, Dev loss: 3.6488804817199707, Bleu Score: 7.92072871970681
2025-12-23 12:28:07,463:INFO: Early Stop Left: 3
2025-12-23 12:31:42,453:INFO: Epoch: 19, loss: 1.0936946868896484
2025-12-23 12:33:19,420:INFO: Epoch: 19, Dev loss: 3.678126573562622, Bleu Score: 7.136136840782252
2025-12-23 12:33:19,421:INFO: Early Stop Left: 2
2025-12-23 12:36:52,364:INFO: Epoch: 20, loss: 1.0471606254577637
2025-12-23 12:38:26,984:INFO: Epoch: 20, Dev loss: 3.7358291149139404, Bleu Score: 7.651211385319671
2025-12-23 12:38:26,985:INFO: Early Stop Left: 1
2025-12-23 12:42:01,872:INFO: Epoch: 21, loss: 1.0056445598602295
2025-12-23 12:43:33,099:INFO: Epoch: 21, Dev loss: 3.7695446014404297, Bleu Score: 7.235860920678547
2025-12-23 12:43:33,100:INFO: Early Stop Left: 0
2025-12-23 12:43:33,100:INFO: -------- Early Stop! --------
2025-12-23 12:43:33,100:INFO: 
============================================================
2025-12-23 12:43:33,101:INFO: Training completed! Evaluating on test set...
2025-12-23 12:43:33,101:INFO: ============================================================
2025-12-23 12:44:18,930:INFO: 
Final Test Set BLEU Score: 7.90
2025-12-23 12:44:21,983:INFO: Test Set BLEU Score (Greedy): 0.00
2025-12-23 12:44:21,984:INFO: Improvement with Beam Search: 7.90 BLEU points
2025-12-23 12:44:21,984:INFO: ============================================================
