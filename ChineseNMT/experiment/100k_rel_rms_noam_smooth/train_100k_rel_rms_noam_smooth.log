2025-12-24 00:07:00,401:INFO: ============================================================
2025-12-24 00:07:00,402:INFO: Training Configuration
2025-12-24 00:07:00,402:INFO: ============================================================
2025-12-24 00:07:00,402:INFO: Dataset: 100k
2025-12-24 00:07:00,402:INFO: Chinese vocab size: 14769
2025-12-24 00:07:00,403:INFO: English vocab size: 8000
2025-12-24 00:07:00,403:INFO: Data directory: ./data_100k
2025-12-24 00:07:00,403:INFO: ============================================================
2025-12-24 00:07:00,403:INFO: Architecture Configuration:
2025-12-24 00:07:00,404:INFO:   Position Encoding: relative
2025-12-24 00:07:00,404:INFO:   Normalization: rmsnorm
2025-12-24 00:07:00,404:INFO:   Max Relative Position: 32
2025-12-24 00:07:00,405:INFO:   Model dimension: 512
2025-12-24 00:07:00,405:INFO:   Attention heads: 8
2025-12-24 00:07:00,405:INFO:   Layers: 6
2025-12-24 00:07:00,405:INFO:   Feed-forward dim: 2048
2025-12-24 00:07:00,406:INFO:   Dropout: 0.1
2025-12-24 00:07:00,406:INFO: ============================================================
2025-12-24 00:07:00,406:INFO: Training Configuration:
2025-12-24 00:07:00,406:INFO:   Batch size: 64
2025-12-24 00:07:00,406:INFO:   Epochs: 50
2025-12-24 00:07:00,407:INFO:   Learning rate: 0.0005
2025-12-24 00:07:00,407:INFO:   Use NoamOpt: True
2025-12-24 00:07:00,407:INFO:   Use Label Smoothing: True
2025-12-24 00:07:00,407:INFO: ============================================================
2025-12-24 00:07:00,407:INFO: Model will be saved to: ./experiment/100k_rel_rms_noam_smooth/model_100k_rel_rms_noam_smooth.pth
2025-12-24 00:07:00,408:INFO: ============================================================
2025-12-24 00:07:00,885:INFO: -------- Dataset Build! --------
2025-12-24 00:07:00,885:INFO: -------- Get Dataloader! --------
2025-12-24 00:07:02,735:DEBUG: Building prefix dict from the default dictionary ...
2025-12-24 00:07:02,735:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-24 00:07:03,329:DEBUG: Loading model cost 0.594 seconds.
2025-12-24 00:07:03,330:DEBUG: Prefix dict has been built successfully.
2025-12-24 00:09:50,529:INFO: Epoch: 1, loss: 4.774085998535156
2025-12-24 00:11:24,759:INFO: Epoch: 1, Dev loss: 4.357232093811035, Bleu Score: 2.054284456467562
2025-12-24 00:11:26,478:INFO: -------- Save Best Model! --------
2025-12-24 00:14:10,789:INFO: Epoch: 2, loss: 3.2468793392181396
2025-12-24 00:15:35,686:INFO: Epoch: 2, Dev loss: 3.8210184574127197, Bleu Score: 3.86839056606956
2025-12-24 00:15:37,209:INFO: -------- Save Best Model! --------
2025-12-24 00:18:22,113:INFO: Epoch: 3, loss: 2.6972625255584717
2025-12-24 00:19:43,910:INFO: Epoch: 3, Dev loss: 3.5128109455108643, Bleu Score: 5.557555097380184
2025-12-24 00:19:45,424:INFO: -------- Save Best Model! --------
2025-12-24 00:22:26,301:INFO: Epoch: 4, loss: 2.3653600215911865
2025-12-24 00:23:47,358:INFO: Epoch: 4, Dev loss: 3.3565542697906494, Bleu Score: 7.574717816492859
2025-12-24 00:23:48,957:INFO: -------- Save Best Model! --------
2025-12-24 00:26:28,512:INFO: Epoch: 5, loss: 2.136152505874634
2025-12-24 00:27:58,646:INFO: Epoch: 5, Dev loss: 3.2667734622955322, Bleu Score: 7.807984819209016
2025-12-24 00:28:00,198:INFO: -------- Save Best Model! --------
2025-12-24 00:30:40,490:INFO: Epoch: 6, loss: 1.959112524986267
2025-12-24 00:32:11,837:INFO: Epoch: 6, Dev loss: 3.2156589031219482, Bleu Score: 7.454968176244898
2025-12-24 00:32:11,839:INFO: Early Stop Left: 4
2025-12-24 00:34:50,739:INFO: Epoch: 7, loss: 1.814940094947815
2025-12-24 00:36:22,105:INFO: Epoch: 7, Dev loss: 3.2083969116210938, Bleu Score: 8.307536950734743
2025-12-24 00:36:23,654:INFO: -------- Save Best Model! --------
2025-12-24 00:39:03,419:INFO: Epoch: 8, loss: 1.6923056840896606
2025-12-24 00:40:36,917:INFO: Epoch: 8, Dev loss: 3.1857922077178955, Bleu Score: 8.98636665895204
2025-12-24 00:40:38,314:INFO: -------- Save Best Model! --------
2025-12-24 00:43:19,508:INFO: Epoch: 9, loss: 1.5880540609359741
2025-12-24 00:44:55,611:INFO: Epoch: 9, Dev loss: 3.189875602722168, Bleu Score: 8.910784918718972
2025-12-24 00:44:55,612:INFO: Early Stop Left: 4
2025-12-24 00:47:36,697:INFO: Epoch: 10, loss: 1.4960224628448486
2025-12-24 00:49:13,385:INFO: Epoch: 10, Dev loss: 3.198240280151367, Bleu Score: 9.824157136865459
2025-12-24 00:49:14,870:INFO: -------- Save Best Model! --------
2025-12-24 00:51:57,130:INFO: Epoch: 11, loss: 1.4149954319000244
2025-12-24 00:53:20,700:INFO: Epoch: 11, Dev loss: 3.2286157608032227, Bleu Score: 8.86092631009053
2025-12-24 00:53:20,702:INFO: Early Stop Left: 4
2025-12-24 00:56:01,704:INFO: Epoch: 12, loss: 1.3431134223937988
2025-12-24 00:57:32,696:INFO: Epoch: 12, Dev loss: 3.264737367630005, Bleu Score: 9.363358333448748
2025-12-24 00:57:32,697:INFO: Early Stop Left: 3
2025-12-24 01:00:15,137:INFO: Epoch: 13, loss: 1.276452660560608
2025-12-24 01:01:45,597:INFO: Epoch: 13, Dev loss: 3.2993640899658203, Bleu Score: 8.696205662622228
2025-12-24 01:01:45,599:INFO: Early Stop Left: 2
2025-12-24 01:04:27,238:INFO: Epoch: 14, loss: 1.2165186405181885
2025-12-24 01:06:07,687:INFO: Epoch: 14, Dev loss: 3.315476894378662, Bleu Score: 9.39750118654189
2025-12-24 01:06:07,688:INFO: Early Stop Left: 1
2025-12-24 01:08:48,300:INFO: Epoch: 15, loss: 1.1616291999816895
2025-12-24 01:10:19,468:INFO: Epoch: 15, Dev loss: 3.3605780601501465, Bleu Score: 9.723283404430514
2025-12-24 01:10:19,469:INFO: Early Stop Left: 0
2025-12-24 01:10:19,470:INFO: -------- Early Stop! --------
2025-12-24 01:10:19,470:INFO: 
============================================================
2025-12-24 01:10:19,471:INFO: Training completed! Evaluating on test set...
2025-12-24 01:10:19,472:INFO: ============================================================
2025-12-24 01:11:14,756:INFO: 
Final Test Set BLEU Score: 8.06
2025-12-24 01:11:17,865:INFO: Test Set BLEU Score (Greedy): 8.49
2025-12-24 01:11:17,866:INFO: Improvement with Beam Search: -0.43 BLEU points
2025-12-24 01:11:17,866:INFO: ============================================================
