2025-12-23 22:59:45,907:INFO: ============================================================
2025-12-23 22:59:45,907:INFO: Training Configuration
2025-12-23 22:59:45,908:INFO: ============================================================
2025-12-23 22:59:45,908:INFO: Dataset: 100k
2025-12-23 22:59:45,908:INFO: Chinese vocab size: 14769
2025-12-23 22:59:45,908:INFO: English vocab size: 8000
2025-12-23 22:59:45,909:INFO: Data directory: ./data_100k
2025-12-23 22:59:45,909:INFO: ============================================================
2025-12-23 22:59:45,909:INFO: Architecture Configuration:
2025-12-23 22:59:45,909:INFO:   Position Encoding: relative
2025-12-23 22:59:45,910:INFO:   Normalization: layernorm
2025-12-23 22:59:45,910:INFO:   Max Relative Position: 32
2025-12-23 22:59:45,910:INFO:   Model dimension: 512
2025-12-23 22:59:45,910:INFO:   Attention heads: 8
2025-12-23 22:59:45,910:INFO:   Layers: 6
2025-12-23 22:59:45,911:INFO:   Feed-forward dim: 2048
2025-12-23 22:59:45,911:INFO:   Dropout: 0.1
2025-12-23 22:59:45,911:INFO: ============================================================
2025-12-23 22:59:45,911:INFO: Training Configuration:
2025-12-23 22:59:45,911:INFO:   Batch size: 64
2025-12-23 22:59:45,912:INFO:   Epochs: 50
2025-12-23 22:59:45,912:INFO:   Learning rate: 0.0005
2025-12-23 22:59:45,912:INFO:   Use NoamOpt: False
2025-12-23 22:59:45,912:INFO:   Use Label Smoothing: False
2025-12-23 22:59:45,912:INFO: ============================================================
2025-12-23 22:59:45,913:INFO: Model will be saved to: ./experiment/100k_rel_ln_adam_nosmooth/model_100k_rel_ln_adam_nosmooth.pth
2025-12-23 22:59:45,913:INFO: ============================================================
2025-12-23 22:59:46,398:INFO: -------- Dataset Build! --------
2025-12-23 22:59:46,398:INFO: -------- Get Dataloader! --------
2025-12-23 22:59:48,287:DEBUG: Building prefix dict from the default dictionary ...
2025-12-23 22:59:48,288:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-23 22:59:48,889:DEBUG: Loading model cost 0.602 seconds.
2025-12-23 22:59:48,890:DEBUG: Prefix dict has been built successfully.
2025-12-23 23:02:40,741:INFO: Epoch: 1, loss: 4.947673797607422
2025-12-23 23:04:47,558:INFO: Epoch: 1, Dev loss: 4.878100395202637, Bleu Score: 1.9068127590560435
2025-12-23 23:04:49,106:INFO: -------- Save Best Model! --------
2025-12-23 23:07:40,679:INFO: Epoch: 2, loss: 3.7151975631713867
2025-12-23 23:09:02,696:INFO: Epoch: 2, Dev loss: 4.398823261260986, Bleu Score: 2.817980353234431
2025-12-23 23:09:04,217:INFO: -------- Save Best Model! --------
2025-12-23 23:11:56,054:INFO: Epoch: 3, loss: 3.123436212539673
2025-12-23 23:13:18,024:INFO: Epoch: 3, Dev loss: 4.152190208435059, Bleu Score: 3.3700338289837988
2025-12-23 23:13:19,537:INFO: -------- Save Best Model! --------
2025-12-23 23:16:10,152:INFO: Epoch: 4, loss: 2.748927354812622
2025-12-23 23:17:53,140:INFO: Epoch: 4, Dev loss: 3.9683969020843506, Bleu Score: 5.05343001756478
2025-12-23 23:17:54,654:INFO: -------- Save Best Model! --------
2025-12-23 23:20:43,702:INFO: Epoch: 5, loss: 2.481358766555786
2025-12-23 23:22:11,312:INFO: Epoch: 5, Dev loss: 3.8711705207824707, Bleu Score: 5.653423141172613
2025-12-23 23:22:12,835:INFO: -------- Save Best Model! --------
2025-12-23 23:24:59,596:INFO: Epoch: 6, loss: 2.2699882984161377
2025-12-23 23:26:26,175:INFO: Epoch: 6, Dev loss: 3.834872245788574, Bleu Score: 5.354843650776068
2025-12-23 23:26:26,177:INFO: Early Stop Left: 4
2025-12-23 23:29:13,751:INFO: Epoch: 7, loss: 2.0948002338409424
2025-12-23 23:30:50,906:INFO: Epoch: 7, Dev loss: 3.8180317878723145, Bleu Score: 6.8154876826707405
2025-12-23 23:30:52,336:INFO: -------- Save Best Model! --------
2025-12-23 23:33:40,957:INFO: Epoch: 8, loss: 1.9396288394927979
2025-12-23 23:35:14,072:INFO: Epoch: 8, Dev loss: 3.8239147663116455, Bleu Score: 7.040038818300364
2025-12-23 23:35:15,570:INFO: -------- Save Best Model! --------
2025-12-23 23:38:04,804:INFO: Epoch: 9, loss: 1.8019232749938965
2025-12-23 23:39:33,413:INFO: Epoch: 9, Dev loss: 3.8789408206939697, Bleu Score: 6.7226035512592475
2025-12-23 23:39:33,414:INFO: Early Stop Left: 4
2025-12-23 23:42:22,260:INFO: Epoch: 10, loss: 1.675832986831665
2025-12-23 23:43:55,648:INFO: Epoch: 10, Dev loss: 3.8947691917419434, Bleu Score: 7.347876685037889
2025-12-23 23:43:57,149:INFO: -------- Save Best Model! --------
2025-12-23 23:46:46,298:INFO: Epoch: 11, loss: 1.5619078874588013
2025-12-23 23:48:20,219:INFO: Epoch: 11, Dev loss: 3.9765844345092773, Bleu Score: 6.754640302538441
2025-12-23 23:48:20,220:INFO: Early Stop Left: 4
2025-12-23 23:51:09,630:INFO: Epoch: 12, loss: 1.458893895149231
2025-12-23 23:52:52,768:INFO: Epoch: 12, Dev loss: 4.050228595733643, Bleu Score: 7.156858763172041
2025-12-23 23:52:52,769:INFO: Early Stop Left: 3
2025-12-23 23:55:41,356:INFO: Epoch: 13, loss: 1.3632508516311646
2025-12-23 23:57:19,259:INFO: Epoch: 13, Dev loss: 4.154696941375732, Bleu Score: 6.604449333921725
2025-12-23 23:57:19,260:INFO: Early Stop Left: 2
2025-12-24 00:00:07,291:INFO: Epoch: 14, loss: 1.275600552558899
2025-12-24 00:01:39,173:INFO: Epoch: 14, Dev loss: 4.246332168579102, Bleu Score: 6.534726882624859
2025-12-24 00:01:39,174:INFO: Early Stop Left: 1
2025-12-24 00:04:28,086:INFO: Epoch: 15, loss: 1.1960982084274292
2025-12-24 00:06:05,582:INFO: Epoch: 15, Dev loss: 4.333371639251709, Bleu Score: 6.295299621011347
2025-12-24 00:06:05,584:INFO: Early Stop Left: 0
2025-12-24 00:06:05,584:INFO: -------- Early Stop! --------
2025-12-24 00:06:05,584:INFO: 
============================================================
2025-12-24 00:06:05,585:INFO: Training completed! Evaluating on test set...
2025-12-24 00:06:05,585:INFO: ============================================================
2025-12-24 00:06:54,379:INFO: 
Final Test Set BLEU Score: 7.59
2025-12-24 00:06:57,808:INFO: Test Set BLEU Score (Greedy): 7.39
2025-12-24 00:06:57,809:INFO: Improvement with Beam Search: 0.20 BLEU points
2025-12-24 00:06:57,810:INFO: ============================================================
