2025-12-23 21:27:26,287:INFO: ============================================================
2025-12-23 21:27:26,288:INFO: Training Configuration
2025-12-23 21:27:26,288:INFO: ============================================================
2025-12-23 21:27:26,288:INFO: Dataset: 100k
2025-12-23 21:27:26,289:INFO: Chinese vocab size: 14769
2025-12-23 21:27:26,289:INFO: English vocab size: 8000
2025-12-23 21:27:26,289:INFO: Data directory: ./data_100k
2025-12-23 21:27:26,290:INFO: ============================================================
2025-12-23 21:27:26,290:INFO: Architecture Configuration:
2025-12-23 21:27:26,291:INFO:   Position Encoding: relative
2025-12-23 21:27:26,291:INFO:   Normalization: layernorm
2025-12-23 21:27:26,291:INFO:   Max Relative Position: 32
2025-12-23 21:27:26,291:INFO:   Model dimension: 512
2025-12-23 21:27:26,292:INFO:   Attention heads: 8
2025-12-23 21:27:26,292:INFO:   Layers: 6
2025-12-23 21:27:26,292:INFO:   Feed-forward dim: 2048
2025-12-23 21:27:26,292:INFO:   Dropout: 0.1
2025-12-23 21:27:26,292:INFO: ============================================================
2025-12-23 21:27:26,293:INFO: Training Configuration:
2025-12-23 21:27:26,293:INFO:   Batch size: 64
2025-12-23 21:27:26,293:INFO:   Epochs: 50
2025-12-23 21:27:26,294:INFO:   Learning rate: 0.0005
2025-12-23 21:27:26,294:INFO:   Use NoamOpt: False
2025-12-23 21:27:26,294:INFO:   Use Label Smoothing: True
2025-12-23 21:27:26,294:INFO: ============================================================
2025-12-23 21:27:26,294:INFO: Model will be saved to: ./experiment/100k_rel_ln_adam_smooth/model_100k_rel_ln_adam_smooth.pth
2025-12-23 21:27:26,295:INFO: ============================================================
2025-12-23 21:27:26,781:INFO: -------- Dataset Build! --------
2025-12-23 21:27:26,781:INFO: -------- Get Dataloader! --------
2025-12-23 21:27:28,690:DEBUG: Building prefix dict from the default dictionary ...
2025-12-23 21:27:28,691:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-23 21:27:29,324:DEBUG: Loading model cost 0.633 seconds.
2025-12-23 21:27:29,325:DEBUG: Prefix dict has been built successfully.
2025-12-23 21:30:30,833:INFO: Epoch: 1, loss: 4.350668430328369
2025-12-23 21:31:45,924:INFO: Epoch: 1, Dev loss: 4.263188362121582, Bleu Score: 2.0878234497847457
2025-12-23 21:31:47,470:INFO: -------- Save Best Model! --------
2025-12-23 21:34:50,485:INFO: Epoch: 2, loss: 3.166530132293701
2025-12-23 21:36:17,753:INFO: Epoch: 2, Dev loss: 3.7598183155059814, Bleu Score: 3.5710548265226105
2025-12-23 21:36:19,302:INFO: -------- Save Best Model! --------
2025-12-23 21:39:18,146:INFO: Epoch: 3, loss: 2.6544933319091797
2025-12-23 21:40:51,129:INFO: Epoch: 3, Dev loss: 3.506852149963379, Bleu Score: 6.023857395830991
2025-12-23 21:40:52,692:INFO: -------- Save Best Model! --------
2025-12-23 21:43:53,237:INFO: Epoch: 4, loss: 2.350595474243164
2025-12-23 21:45:17,283:INFO: Epoch: 4, Dev loss: 3.3849620819091797, Bleu Score: 6.978176705607877
2025-12-23 21:45:18,862:INFO: -------- Save Best Model! --------
2025-12-23 21:48:27,513:INFO: Epoch: 5, loss: 2.1360278129577637
2025-12-23 21:49:57,026:INFO: Epoch: 5, Dev loss: 3.3098340034484863, Bleu Score: 7.3079244628337285
2025-12-23 21:49:58,640:INFO: -------- Save Best Model! --------
2025-12-23 21:53:05,710:INFO: Epoch: 6, loss: 1.9689967632293701
2025-12-23 21:54:37,634:INFO: Epoch: 6, Dev loss: 3.2319040298461914, Bleu Score: 8.348329963083817
2025-12-23 21:54:39,137:INFO: -------- Save Best Model! --------
2025-12-23 21:57:44,031:INFO: Epoch: 7, loss: 1.8306725025177002
2025-12-23 21:59:11,332:INFO: Epoch: 7, Dev loss: 3.217146873474121, Bleu Score: 8.108890178599642
2025-12-23 21:59:11,332:INFO: Early Stop Left: 4
2025-12-23 22:02:14,286:INFO: Epoch: 8, loss: 1.7106742858886719
2025-12-23 22:03:45,048:INFO: Epoch: 8, Dev loss: 3.2235023975372314, Bleu Score: 8.215989755000981
2025-12-23 22:03:45,049:INFO: Early Stop Left: 3
2025-12-23 22:06:43,445:INFO: Epoch: 9, loss: 1.6048696041107178
2025-12-23 22:08:19,874:INFO: Epoch: 9, Dev loss: 3.2405765056610107, Bleu Score: 8.260611116539165
2025-12-23 22:08:19,875:INFO: Early Stop Left: 2
2025-12-23 22:11:14,695:INFO: Epoch: 10, loss: 1.511999249458313
2025-12-23 22:12:53,644:INFO: Epoch: 10, Dev loss: 3.255383014678955, Bleu Score: 8.964730487538999
2025-12-23 22:12:55,183:INFO: -------- Save Best Model! --------
2025-12-23 22:15:48,093:INFO: Epoch: 11, loss: 1.4263805150985718
2025-12-23 22:17:22,410:INFO: Epoch: 11, Dev loss: 3.270024061203003, Bleu Score: 8.196075777711062
2025-12-23 22:17:22,411:INFO: Early Stop Left: 4
2025-12-23 22:20:15,640:INFO: Epoch: 12, loss: 1.349311351776123
2025-12-23 22:21:44,689:INFO: Epoch: 12, Dev loss: 3.317300319671631, Bleu Score: 8.838898342494469
2025-12-23 22:21:44,690:INFO: Early Stop Left: 3
2025-12-23 22:24:45,308:INFO: Epoch: 13, loss: 1.2787494659423828
2025-12-23 22:26:12,258:INFO: Epoch: 13, Dev loss: 3.343846082687378, Bleu Score: 8.443741065779037
2025-12-23 22:26:12,260:INFO: Early Stop Left: 2
2025-12-23 22:29:14,723:INFO: Epoch: 14, loss: 1.2131526470184326
2025-12-23 22:30:51,983:INFO: Epoch: 14, Dev loss: 3.408306837081909, Bleu Score: 8.747389307572009
2025-12-23 22:30:51,984:INFO: Early Stop Left: 1
2025-12-23 22:34:06,798:INFO: Epoch: 15, loss: 1.1529932022094727
2025-12-23 22:35:47,326:INFO: Epoch: 15, Dev loss: 3.44734525680542, Bleu Score: 8.992537059209626
2025-12-23 22:35:48,895:INFO: -------- Save Best Model! --------
2025-12-23 22:38:46,342:INFO: Epoch: 16, loss: 1.096949577331543
2025-12-23 22:40:26,023:INFO: Epoch: 16, Dev loss: 3.4855427742004395, Bleu Score: 8.443996703630702
2025-12-23 22:40:26,024:INFO: Early Stop Left: 4
2025-12-23 22:43:19,287:INFO: Epoch: 17, loss: 1.0474611520767212
2025-12-23 22:44:56,064:INFO: Epoch: 17, Dev loss: 3.5357682704925537, Bleu Score: 8.208316679689727
2025-12-23 22:44:56,065:INFO: Early Stop Left: 3
2025-12-23 22:47:51,246:INFO: Epoch: 18, loss: 1.0003708600997925
2025-12-23 22:49:32,136:INFO: Epoch: 18, Dev loss: 3.5605664253234863, Bleu Score: 8.85512046948142
2025-12-23 22:49:32,137:INFO: Early Stop Left: 2
2025-12-23 22:52:29,842:INFO: Epoch: 19, loss: 0.9567310810089111
2025-12-23 22:54:14,443:INFO: Epoch: 19, Dev loss: 3.5716159343719482, Bleu Score: 8.189408733545044
2025-12-23 22:54:14,444:INFO: Early Stop Left: 1
2025-12-23 22:57:09,952:INFO: Epoch: 20, loss: 0.9167430400848389
2025-12-23 22:58:55,049:INFO: Epoch: 20, Dev loss: 3.6252524852752686, Bleu Score: 8.406495087737706
2025-12-23 22:58:55,049:INFO: Early Stop Left: 0
2025-12-23 22:58:55,050:INFO: -------- Early Stop! --------
2025-12-23 22:58:55,050:INFO: 
============================================================
2025-12-23 22:58:55,050:INFO: Training completed! Evaluating on test set...
2025-12-23 22:58:55,050:INFO: ============================================================
2025-12-23 22:59:40,123:INFO: 
Final Test Set BLEU Score: 8.67
2025-12-23 22:59:43,335:INFO: Test Set BLEU Score (Greedy): 8.70
2025-12-23 22:59:43,336:INFO: Improvement with Beam Search: -0.03 BLEU points
2025-12-23 22:59:43,336:INFO: ============================================================
