2025-12-24 03:27:56,102:INFO: ============================================================
2025-12-24 03:27:56,103:INFO: Training Configuration
2025-12-24 03:27:56,103:INFO: ============================================================
2025-12-24 03:27:56,103:INFO: Dataset: 100k
2025-12-24 03:27:56,103:INFO: Chinese vocab size: 14769
2025-12-24 03:27:56,104:INFO: English vocab size: 8000
2025-12-24 03:27:56,104:INFO: Data directory: ./data_100k
2025-12-24 03:27:56,104:INFO: ============================================================
2025-12-24 03:27:56,104:INFO: Architecture Configuration:
2025-12-24 03:27:56,105:INFO:   Position Encoding: relative
2025-12-24 03:27:56,105:INFO:   Normalization: rmsnorm
2025-12-24 03:27:56,105:INFO:   Max Relative Position: 32
2025-12-24 03:27:56,105:INFO:   Model dimension: 512
2025-12-24 03:27:56,105:INFO:   Attention heads: 8
2025-12-24 03:27:56,106:INFO:   Layers: 6
2025-12-24 03:27:56,106:INFO:   Feed-forward dim: 2048
2025-12-24 03:27:56,106:INFO:   Dropout: 0.1
2025-12-24 03:27:56,106:INFO: ============================================================
2025-12-24 03:27:56,106:INFO: Training Configuration:
2025-12-24 03:27:56,107:INFO:   Batch size: 64
2025-12-24 03:27:56,107:INFO:   Epochs: 50
2025-12-24 03:27:56,107:INFO:   Learning rate: 0.0005
2025-12-24 03:27:56,107:INFO:   Use NoamOpt: False
2025-12-24 03:27:56,107:INFO:   Use Label Smoothing: False
2025-12-24 03:27:56,107:INFO: ============================================================
2025-12-24 03:27:56,108:INFO: Model will be saved to: ./experiment/100k_rel_rms_adam_nosmooth/model_100k_rel_rms_adam_nosmooth.pth
2025-12-24 03:27:56,108:INFO: ============================================================
2025-12-24 03:27:56,533:INFO: -------- Dataset Build! --------
2025-12-24 03:27:56,534:INFO: -------- Get Dataloader! --------
2025-12-24 03:27:58,236:DEBUG: Building prefix dict from the default dictionary ...
2025-12-24 03:27:58,237:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-24 03:27:58,768:DEBUG: Loading model cost 0.531 seconds.
2025-12-24 03:27:58,769:DEBUG: Prefix dict has been built successfully.
2025-12-24 03:30:35,420:INFO: Epoch: 1, loss: 4.90012264251709
2025-12-24 03:31:52,221:INFO: Epoch: 1, Dev loss: 4.793139934539795, Bleu Score: 2.129800618506167
2025-12-24 03:31:53,621:INFO: -------- Save Best Model! --------
2025-12-24 03:34:31,113:INFO: Epoch: 2, loss: 3.513765335083008
2025-12-24 03:35:49,110:INFO: Epoch: 2, Dev loss: 4.284273147583008, Bleu Score: 3.787001702987919
2025-12-24 03:35:50,691:INFO: -------- Save Best Model! --------
2025-12-24 03:38:31,207:INFO: Epoch: 3, loss: 2.939330816268921
2025-12-24 03:40:05,761:INFO: Epoch: 3, Dev loss: 4.029217720031738, Bleu Score: 5.800583316006806
2025-12-24 03:40:07,412:INFO: -------- Save Best Model! --------
2025-12-24 03:42:50,526:INFO: Epoch: 4, loss: 2.5934107303619385
2025-12-24 03:44:13,731:INFO: Epoch: 4, Dev loss: 3.8514552116394043, Bleu Score: 6.725608363324526
2025-12-24 03:44:17,081:INFO: -------- Save Best Model! --------
2025-12-24 03:47:01,289:INFO: Epoch: 5, loss: 2.3445420265197754
2025-12-24 03:48:25,233:INFO: Epoch: 5, Dev loss: 3.729656219482422, Bleu Score: 7.052315821300937
2025-12-24 03:48:26,746:INFO: -------- Save Best Model! --------
2025-12-24 03:51:05,174:INFO: Epoch: 6, loss: 2.146604299545288
2025-12-24 03:52:34,336:INFO: Epoch: 6, Dev loss: 3.6915526390075684, Bleu Score: 7.7166218826999025
2025-12-24 03:52:35,911:INFO: -------- Save Best Model! --------
2025-12-24 03:55:13,696:INFO: Epoch: 7, loss: 1.9785614013671875
2025-12-24 03:56:51,782:INFO: Epoch: 7, Dev loss: 3.7086551189422607, Bleu Score: 7.530814264867562
2025-12-24 03:56:51,782:INFO: Early Stop Left: 4
2025-12-24 03:59:29,031:INFO: Epoch: 8, loss: 1.8316781520843506
2025-12-24 04:01:04,023:INFO: Epoch: 8, Dev loss: 3.6930489540100098, Bleu Score: 8.486530447849537
2025-12-24 04:01:05,483:INFO: -------- Save Best Model! --------
2025-12-24 04:03:41,037:INFO: Epoch: 9, loss: 1.7000240087509155
2025-12-24 04:05:17,962:INFO: Epoch: 9, Dev loss: 3.7440402507781982, Bleu Score: 8.462377322575518
2025-12-24 04:05:17,963:INFO: Early Stop Left: 4
2025-12-24 04:07:51,856:INFO: Epoch: 10, loss: 1.5823974609375
2025-12-24 04:09:31,605:INFO: Epoch: 10, Dev loss: 3.786280393600464, Bleu Score: 8.220381945913914
2025-12-24 04:09:31,606:INFO: Early Stop Left: 3
2025-12-24 04:12:03,441:INFO: Epoch: 11, loss: 1.4743156433105469
2025-12-24 04:13:30,538:INFO: Epoch: 11, Dev loss: 3.857590675354004, Bleu Score: 7.912165480066504
2025-12-24 04:13:30,539:INFO: Early Stop Left: 2
2025-12-24 04:16:03,275:INFO: Epoch: 12, loss: 1.3751405477523804
2025-12-24 04:17:39,608:INFO: Epoch: 12, Dev loss: 3.9267609119415283, Bleu Score: 7.668786811135602
2025-12-24 04:17:39,609:INFO: Early Stop Left: 1
2025-12-24 04:20:11,506:INFO: Epoch: 13, loss: 1.2846347093582153
2025-12-24 04:21:50,260:INFO: Epoch: 13, Dev loss: 4.030600547790527, Bleu Score: 8.17040326042682
2025-12-24 04:21:50,261:INFO: Early Stop Left: 0
2025-12-24 04:21:50,262:INFO: -------- Early Stop! --------
2025-12-24 04:21:50,262:INFO: 
============================================================
2025-12-24 04:21:50,262:INFO: Training completed! Evaluating on test set...
2025-12-24 04:21:50,262:INFO: ============================================================
2025-12-24 04:22:42,359:INFO: 
Final Test Set BLEU Score: 7.95
2025-12-24 04:22:45,451:INFO: Test Set BLEU Score (Greedy): 8.27
2025-12-24 04:22:45,452:INFO: Improvement with Beam Search: -0.32 BLEU points
2025-12-24 04:22:45,452:INFO: ============================================================
