2025-12-23 18:35:26,596:INFO: ============================================================
2025-12-23 18:35:26,596:INFO: Training Configuration
2025-12-23 18:35:26,596:INFO: ============================================================
2025-12-23 18:35:26,597:INFO: Dataset: 100k
2025-12-23 18:35:26,597:INFO: Chinese vocab size: 14769
2025-12-23 18:35:26,597:INFO: English vocab size: 8000
2025-12-23 18:35:26,597:INFO: Data directory: ./data_100k
2025-12-23 18:35:26,598:INFO: ============================================================
2025-12-23 18:35:26,598:INFO: Architecture Configuration:
2025-12-23 18:35:26,598:INFO:   Position Encoding: relative
2025-12-23 18:35:26,599:INFO:   Normalization: layernorm
2025-12-23 18:35:26,599:INFO:   Max Relative Position: 32
2025-12-23 18:35:26,599:INFO:   Model dimension: 512
2025-12-23 18:35:26,599:INFO:   Attention heads: 8
2025-12-23 18:35:26,600:INFO:   Layers: 6
2025-12-23 18:35:26,600:INFO:   Feed-forward dim: 2048
2025-12-23 18:35:26,600:INFO:   Dropout: 0.1
2025-12-23 18:35:26,600:INFO: ============================================================
2025-12-23 18:35:26,601:INFO: Training Configuration:
2025-12-23 18:35:26,601:INFO:   Batch size: 64
2025-12-23 18:35:26,601:INFO:   Epochs: 50
2025-12-23 18:35:26,601:INFO:   Learning rate: 0.0005
2025-12-23 18:35:26,602:INFO:   Use NoamOpt: True
2025-12-23 18:35:26,602:INFO:   Use Label Smoothing: True
2025-12-23 18:35:26,602:INFO: ============================================================
2025-12-23 18:35:26,602:INFO: Model will be saved to: ./experiment/100k_rel_ln_noam_smooth/model_100k_rel_ln_noam_smooth.pth
2025-12-23 18:35:26,603:INFO: ============================================================
2025-12-23 18:35:27,354:INFO: -------- Dataset Build! --------
2025-12-23 18:35:27,354:INFO: -------- Get Dataloader! --------
2025-12-23 18:35:29,784:DEBUG: Building prefix dict from the default dictionary ...
2025-12-23 18:35:29,785:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-23 18:35:30,503:DEBUG: Loading model cost 0.718 seconds.
2025-12-23 18:35:30,504:DEBUG: Prefix dict has been built successfully.
2025-12-23 18:38:32,516:INFO: Epoch: 1, loss: 4.713339805603027
2025-12-23 18:40:03,178:INFO: Epoch: 1, Dev loss: 4.294255256652832, Bleu Score: 2.081440018836141
2025-12-23 18:40:04,712:INFO: -------- Save Best Model! --------
2025-12-23 18:43:10,008:INFO: Epoch: 2, loss: 3.205303430557251
2025-12-23 18:44:32,084:INFO: Epoch: 2, Dev loss: 3.7469823360443115, Bleu Score: 3.809295351556813
2025-12-23 18:44:33,633:INFO: -------- Save Best Model! --------
2025-12-23 18:47:41,925:INFO: Epoch: 3, loss: 2.673967123031616
2025-12-23 18:49:09,907:INFO: Epoch: 3, Dev loss: 3.5099234580993652, Bleu Score: 6.193355041522395
2025-12-23 18:49:11,396:INFO: -------- Save Best Model! --------
2025-12-23 18:52:18,366:INFO: Epoch: 4, loss: 2.347395658493042
2025-12-23 18:53:48,706:INFO: Epoch: 4, Dev loss: 3.3698225021362305, Bleu Score: 7.095492394722322
2025-12-23 18:53:50,285:INFO: -------- Save Best Model! --------
2025-12-23 18:56:52,333:INFO: Epoch: 5, loss: 2.1220433712005615
2025-12-23 18:58:20,963:INFO: Epoch: 5, Dev loss: 3.283658266067505, Bleu Score: 7.741889929572836
2025-12-23 18:58:22,470:INFO: -------- Save Best Model! --------
2025-12-23 19:01:42,643:INFO: Epoch: 6, loss: 1.947340488433838
2025-12-23 19:03:17,700:INFO: Epoch: 6, Dev loss: 3.2256650924682617, Bleu Score: 8.435428999674391
2025-12-23 19:03:19,300:INFO: -------- Save Best Model! --------
2025-12-23 19:06:15,593:INFO: Epoch: 7, loss: 1.8045783042907715
2025-12-23 19:07:50,707:INFO: Epoch: 7, Dev loss: 3.193629503250122, Bleu Score: 8.877839756249214
2025-12-23 19:07:52,256:INFO: -------- Save Best Model! --------
2025-12-23 19:10:48,102:INFO: Epoch: 8, loss: 1.682342529296875
2025-12-23 19:12:21,896:INFO: Epoch: 8, Dev loss: 3.200100898742676, Bleu Score: 9.092987721508592
2025-12-23 19:12:23,385:INFO: -------- Save Best Model! --------
2025-12-23 19:15:19,582:INFO: Epoch: 9, loss: 1.5778281688690186
2025-12-23 19:16:47,585:INFO: Epoch: 9, Dev loss: 3.207043170928955, Bleu Score: 8.14670849209289
2025-12-23 19:16:47,586:INFO: Early Stop Left: 4
2025-12-23 19:19:42,315:INFO: Epoch: 10, loss: 1.4847179651260376
2025-12-23 19:21:17,166:INFO: Epoch: 10, Dev loss: 3.2301902770996094, Bleu Score: 9.215621915867693
2025-12-23 19:21:18,694:INFO: -------- Save Best Model! --------
2025-12-23 19:24:13,297:INFO: Epoch: 11, loss: 1.4037481546401978
2025-12-23 19:25:52,560:INFO: Epoch: 11, Dev loss: 3.2569448947906494, Bleu Score: 9.171387177045633
2025-12-23 19:25:52,561:INFO: Early Stop Left: 4
2025-12-23 19:28:47,243:INFO: Epoch: 12, loss: 1.3298794031143188
2025-12-23 19:30:24,802:INFO: Epoch: 12, Dev loss: 3.291826009750366, Bleu Score: 9.094974929394116
2025-12-23 19:30:24,803:INFO: Early Stop Left: 3
2025-12-23 19:33:29,035:INFO: Epoch: 13, loss: 1.2634479999542236
2025-12-23 19:35:01,523:INFO: Epoch: 13, Dev loss: 3.3106095790863037, Bleu Score: 9.473590557945576
2025-12-23 19:35:03,078:INFO: -------- Save Best Model! --------
2025-12-23 19:38:00,315:INFO: Epoch: 14, loss: 1.2032814025878906
2025-12-23 19:39:32,911:INFO: Epoch: 14, Dev loss: 3.3316497802734375, Bleu Score: 9.411527452955479
2025-12-23 19:39:32,912:INFO: Early Stop Left: 4
2025-12-23 19:42:30,967:INFO: Epoch: 15, loss: 1.1472716331481934
2025-12-23 19:44:07,779:INFO: Epoch: 15, Dev loss: 3.401280641555786, Bleu Score: 9.675737803074583
2025-12-23 19:44:09,323:INFO: -------- Save Best Model! --------
2025-12-23 19:47:05,073:INFO: Epoch: 16, loss: 1.0976166725158691
2025-12-23 19:48:43,803:INFO: Epoch: 16, Dev loss: 3.4228014945983887, Bleu Score: 9.371975543810837
2025-12-23 19:48:43,804:INFO: Early Stop Left: 4
2025-12-23 19:51:38,797:INFO: Epoch: 17, loss: 1.051127552986145
2025-12-23 19:53:09,495:INFO: Epoch: 17, Dev loss: 3.467149496078491, Bleu Score: 9.213461693760907
2025-12-23 19:53:09,496:INFO: Early Stop Left: 3
2025-12-23 19:56:03,175:INFO: Epoch: 18, loss: 1.0077835321426392
2025-12-23 19:57:39,476:INFO: Epoch: 18, Dev loss: 3.4920685291290283, Bleu Score: 9.091448651926259
2025-12-23 19:57:39,477:INFO: Early Stop Left: 2
2025-12-23 20:00:33,245:INFO: Epoch: 19, loss: 0.9696686863899231
2025-12-23 20:02:08,721:INFO: Epoch: 19, Dev loss: 3.530078649520874, Bleu Score: 8.775740570819943
2025-12-23 20:02:08,722:INFO: Early Stop Left: 1
2025-12-23 20:05:05,602:INFO: Epoch: 20, loss: 0.9334251880645752
2025-12-23 20:06:45,648:INFO: Epoch: 20, Dev loss: 3.5357513427734375, Bleu Score: 8.417994517856465
2025-12-23 20:06:45,649:INFO: Early Stop Left: 0
2025-12-23 20:06:45,650:INFO: -------- Early Stop! --------
2025-12-23 20:06:45,650:INFO: 
============================================================
2025-12-23 20:06:45,650:INFO: Training completed! Evaluating on test set...
2025-12-23 20:06:45,650:INFO: ============================================================
2025-12-23 20:07:34,029:INFO: 
Final Test Set BLEU Score: 8.91
2025-12-23 20:07:37,311:INFO: Test Set BLEU Score (Greedy): 9.11
2025-12-23 20:07:37,312:INFO: Improvement with Beam Search: -0.20 BLEU points
2025-12-23 20:07:37,312:INFO: ============================================================
