2025-12-24 02:17:48,440:INFO: ============================================================
2025-12-24 02:17:48,441:INFO: Training Configuration
2025-12-24 02:17:48,441:INFO: ============================================================
2025-12-24 02:17:48,441:INFO: Dataset: 100k
2025-12-24 02:17:48,441:INFO: Chinese vocab size: 14769
2025-12-24 02:17:48,442:INFO: English vocab size: 8000
2025-12-24 02:17:48,442:INFO: Data directory: ./data_100k
2025-12-24 02:17:48,442:INFO: ============================================================
2025-12-24 02:17:48,443:INFO: Architecture Configuration:
2025-12-24 02:17:48,443:INFO:   Position Encoding: relative
2025-12-24 02:17:48,443:INFO:   Normalization: rmsnorm
2025-12-24 02:17:48,444:INFO:   Max Relative Position: 32
2025-12-24 02:17:48,444:INFO:   Model dimension: 512
2025-12-24 02:17:48,444:INFO:   Attention heads: 8
2025-12-24 02:17:48,444:INFO:   Layers: 6
2025-12-24 02:17:48,445:INFO:   Feed-forward dim: 2048
2025-12-24 02:17:48,445:INFO:   Dropout: 0.1
2025-12-24 02:17:48,445:INFO: ============================================================
2025-12-24 02:17:48,445:INFO: Training Configuration:
2025-12-24 02:17:48,446:INFO:   Batch size: 64
2025-12-24 02:17:48,446:INFO:   Epochs: 50
2025-12-24 02:17:48,446:INFO:   Learning rate: 0.0005
2025-12-24 02:17:48,446:INFO:   Use NoamOpt: False
2025-12-24 02:17:48,447:INFO:   Use Label Smoothing: True
2025-12-24 02:17:48,447:INFO: ============================================================
2025-12-24 02:17:48,447:INFO: Model will be saved to: ./experiment/100k_rel_rms_adam_smooth/model_100k_rel_rms_adam_smooth.pth
2025-12-24 02:17:48,447:INFO: ============================================================
2025-12-24 02:17:48,923:INFO: -------- Dataset Build! --------
2025-12-24 02:17:48,924:INFO: -------- Get Dataloader! --------
2025-12-24 02:17:50,805:DEBUG: Building prefix dict from the default dictionary ...
2025-12-24 02:17:50,806:DEBUG: Loading model from cache /tmp/jieba.cache
2025-12-24 02:17:51,398:DEBUG: Loading model cost 0.592 seconds.
2025-12-24 02:17:51,399:DEBUG: Prefix dict has been built successfully.
2025-12-24 02:20:36,257:INFO: Epoch: 1, loss: 4.307111740112305
2025-12-24 02:21:58,376:INFO: Epoch: 1, Dev loss: 4.21140718460083, Bleu Score: 2.1405402187775855
2025-12-24 02:21:59,940:INFO: -------- Save Best Model! --------
2025-12-24 02:24:46,110:INFO: Epoch: 2, loss: 3.1240763664245605
2025-12-24 02:26:18,241:INFO: Epoch: 2, Dev loss: 3.7031450271606445, Bleu Score: 4.674549027303713
2025-12-24 02:26:19,695:INFO: -------- Save Best Model! --------
2025-12-24 02:29:04,920:INFO: Epoch: 3, loss: 2.620065450668335
2025-12-24 02:30:31,876:INFO: Epoch: 3, Dev loss: 3.4848341941833496, Bleu Score: 5.786608983180364
2025-12-24 02:30:33,310:INFO: -------- Save Best Model! --------
2025-12-24 02:33:13,130:INFO: Epoch: 4, loss: 2.3190200328826904
2025-12-24 02:34:37,262:INFO: Epoch: 4, Dev loss: 3.3458080291748047, Bleu Score: 7.679944622928509
2025-12-24 02:34:38,712:INFO: -------- Save Best Model! --------
2025-12-24 02:37:22,940:INFO: Epoch: 5, loss: 2.105997085571289
2025-12-24 02:38:49,737:INFO: Epoch: 5, Dev loss: 3.2839581966400146, Bleu Score: 7.866906917093639
2025-12-24 02:38:51,357:INFO: -------- Save Best Model! --------
2025-12-24 02:41:34,665:INFO: Epoch: 6, loss: 1.9406237602233887
2025-12-24 02:43:13,632:INFO: Epoch: 6, Dev loss: 3.2036664485931396, Bleu Score: 8.440234873165952
2025-12-24 02:43:15,186:INFO: -------- Save Best Model! --------
2025-12-24 02:46:00,630:INFO: Epoch: 7, loss: 1.8034629821777344
2025-12-24 02:47:33,648:INFO: Epoch: 7, Dev loss: 3.213923454284668, Bleu Score: 8.115036664299488
2025-12-24 02:47:33,649:INFO: Early Stop Left: 4
2025-12-24 02:50:16,970:INFO: Epoch: 8, loss: 1.6865227222442627
2025-12-24 02:51:43,977:INFO: Epoch: 8, Dev loss: 3.212397575378418, Bleu Score: 7.965572113728835
2025-12-24 02:51:43,978:INFO: Early Stop Left: 3
2025-12-24 02:54:27,153:INFO: Epoch: 9, loss: 1.5836453437805176
2025-12-24 02:56:01,256:INFO: Epoch: 9, Dev loss: 3.217224359512329, Bleu Score: 8.797068690557001
2025-12-24 02:56:02,825:INFO: -------- Save Best Model! --------
2025-12-24 02:58:44,797:INFO: Epoch: 10, loss: 1.4916856288909912
2025-12-24 03:00:29,600:INFO: Epoch: 10, Dev loss: 3.247653007507324, Bleu Score: 8.986046702917422
2025-12-24 03:00:31,138:INFO: -------- Save Best Model! --------
2025-12-24 03:03:14,307:INFO: Epoch: 11, loss: 1.4102107286453247
2025-12-24 03:04:46,347:INFO: Epoch: 11, Dev loss: 3.2666592597961426, Bleu Score: 9.689514987887314
2025-12-24 03:04:47,931:INFO: -------- Save Best Model! --------
2025-12-24 03:07:30,954:INFO: Epoch: 12, loss: 1.3334522247314453
2025-12-24 03:09:07,389:INFO: Epoch: 12, Dev loss: 3.314908027648926, Bleu Score: 9.17790643572775
2025-12-24 03:09:07,390:INFO: Early Stop Left: 4
2025-12-24 03:11:51,652:INFO: Epoch: 13, loss: 1.2646842002868652
2025-12-24 03:13:34,254:INFO: Epoch: 13, Dev loss: 3.345649003982544, Bleu Score: 8.697339754524924
2025-12-24 03:13:34,255:INFO: Early Stop Left: 3
2025-12-24 03:16:18,283:INFO: Epoch: 14, loss: 1.201137661933899
2025-12-24 03:18:10,412:INFO: Epoch: 14, Dev loss: 3.3727521896362305, Bleu Score: 9.236768190521442
2025-12-24 03:18:10,412:INFO: Early Stop Left: 2
2025-12-24 03:20:54,516:INFO: Epoch: 15, loss: 1.142439603805542
2025-12-24 03:22:44,451:INFO: Epoch: 15, Dev loss: 3.432910680770874, Bleu Score: 9.3793538111863
2025-12-24 03:22:44,452:INFO: Early Stop Left: 1
2025-12-24 03:25:29,139:INFO: Epoch: 16, loss: 1.088277816772461
2025-12-24 03:27:03,090:INFO: Epoch: 16, Dev loss: 3.4751293659210205, Bleu Score: 8.748039571971525
2025-12-24 03:27:03,090:INFO: Early Stop Left: 0
2025-12-24 03:27:03,091:INFO: -------- Early Stop! --------
2025-12-24 03:27:03,091:INFO: 
============================================================
2025-12-24 03:27:03,091:INFO: Training completed! Evaluating on test set...
2025-12-24 03:27:03,092:INFO: ============================================================
2025-12-24 03:27:50,812:INFO: 
Final Test Set BLEU Score: 9.50
2025-12-24 03:27:53,769:INFO: Test Set BLEU Score (Greedy): 9.68
2025-12-24 03:27:53,770:INFO: Improvement with Beam Search: -0.18 BLEU points
2025-12-24 03:27:53,770:INFO: ============================================================
